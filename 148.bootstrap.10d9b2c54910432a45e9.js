"use strict";(self.webpackChunkwasm_game_of_life_app=self.webpackChunkwasm_game_of_life_app||[]).push([[148],{409:(t,e,s)=>{s.d(e,{bL:()=>h,Pd:()=>a,KV:()=>l,Or:()=>c});var i=s(422);t=s.hmd(t);let r=new("undefined"==typeof TextDecoder?(0,t.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});r.decode();let n=null;const h=Object.freeze({Dead:0,0:"Dead",Alive:1,1:"Alive"});class a{static __wrap(t){const e=Object.create(a.prototype);return e.ptr=t,e}__destroy_into_raw(){const t=this.ptr;return this.ptr=0,t}free(){const t=this.__destroy_into_raw();i.__wbg_universe_free(t)}static new(t,e){var s=i.universe_new(t,e);return a.__wrap(s)}tick(){i.universe_tick(this.ptr)}cells(){return i.universe_cells(this.ptr)}cells_diff(){return i.universe_cells_diff(this.ptr)}cells_diff_len(){return i.universe_cells_diff_len(this.ptr)>>>0}get_index(t,e){return i.universe_get_index(this.ptr,t,e)>>>0}toggle_cell(t,e){i.universe_toggle_cell(this.ptr,t,e)}set_all_dead(){i.universe_set_all_dead(this.ptr)}set_random(){i.universe_set_random(this.ptr)}spawn_glider(t,e){i.universe_spawn_glider(this.ptr,t,e)}spawn_pulsar(t,e){i.universe_spawn_pulsar(this.ptr,t,e)}}const l="function"==typeof Math.random?Math.random:("Math.random",()=>{throw new Error("Math.random is not defined")});function c(t,e){throw new Error((s=t,h=e,r.decode((null!==n&&n.buffer===i.memory.buffer||(n=new Uint8Array(i.memory.buffer)),n).subarray(s,s+h))));var s,h}},148:(t,e,s)=>{s.r(e),s(169);var i=s(409),r=s(422);class n{constructor(){this.fps=document.querySelector(".fps"),this.buffer=500,this.frames=[],this.lastFrameTimeStamp=performance.now()}render(){const t=performance.now(),e=t-this.lastFrameTimeStamp;this.lastFrameTimeStamp=t;const s=1/e*1e3;this.frames.push(s),this.frames.length>this.buffer&&this.frames.shift();let i=1/0,r=-1/0,n=0;for(let t=0;t<this.frames.length;++t){const e=this.frames[t];n+=e,i=Math.min(e,i),r=Math.max(e,r)}n/=this.frames.length,this.fps.innerHTML=`\nFPS:<br>\n&nbsp;&nbsp;Min: ${i.toFixed(2)}<br>\n&nbsp;&nbsp;Max: ${r.toFixed(2)}<br>\n&nbsp;&nbsp;Avg: ${n.toFixed(2)}`}}let h=null;const a=()=>{E.render(),h=requestAnimationFrame(a)},l=document.getElementById("btn-tick"),c=document.getElementById("btn-pause"),d=document.getElementById("btn-reset-dead"),o=document.getElementById("btn-reset-random"),u=()=>{c.querySelector("img").setAttribute("src","assets/pause.svg"),l.disabled=!0,a()};c.addEventListener("click",(()=>{null===h?u():(c.querySelector("img").setAttribute("src","assets/play.svg"),cancelAnimationFrame(h),l.disabled=!1,h=null)})),l.addEventListener("click",(()=>{E.tick()})),d.addEventListener("click",(()=>{E.set_all_dead()})),o.addEventListener("click",(()=>{E.set_random()}));const _={Alt:{enabled:!1,method:"glider"},Shift:{enabled:!1,method:"pulsar"}},f=()=>{Object.values(_).forEach((t=>t.enabled=!1))};document.addEventListener("keydown",(t=>{const e=_[t.key];e&&(e.enabled=!0)})),document.addEventListener("keyup",(t=>{f()}));let m,p=0;document.addEventListener("click",(t=>{"touch"===t.pointerType?(0===p&&setTimeout((()=>{switch(f(),p){case 2:_.Alt.enabled=!0;break;case 3:_.Shift.enabled=!0}v(m),f(),p=0}),350),p+=1,m=t):v(t)}));const v=t=>{let e;for(let t of Object.values(_))t.enabled&&(e=t.method);E.handle_canvas_click(t,e)},E=(new class{constructor(){this.fps=new n;const t=getComputedStyle(document.body);this.GRID_COLOR=t.getPropertyValue("--theme-grid"),this.DEAD_COLOR=t.getPropertyValue("--theme-bg"),this.ALIVE_COLOR=t.getPropertyValue("--theme-cell-alive"),this.CELL_SIZE=7;const e=document.querySelector(".canvas-container");this.uWidth=~~(e.clientWidth/(this.CELL_SIZE+1)),this.uHeight=~~(e.clientHeight/(this.CELL_SIZE+1)),this.canvas=document.getElementById("wasm-canvas"),this.canvas.height=(this.CELL_SIZE+1)*this.uHeight+1,this.canvas.width=(this.CELL_SIZE+1)*this.uWidth+1,this.ctx=this.canvas.getContext("2d")}jumpstart(){return this.universe=i.Pd.new(this.uWidth,this.uHeight),this.universe.set_random(),this.drawGrid(),this.drawCells(),this}render(){this.fps.render(),this.universe.tick(),this.drawCells()}tick(){this.universe.tick(),this.drawCells()}set_all_dead(){this.universe.set_all_dead(),this.drawCells()}set_random(){this.universe.set_random(),this.drawCells()}handle_canvas_click(t,e){if(t.srcElement==this.canvas){const s=this.canvas.getBoundingClientRect(),i=this.canvas.width/s.width,r=this.canvas.height/s.height,n=(t.clientX-s.left)*i,h=(t.clientY-s.top)*r,a=Math.min(Math.floor(h/(this.CELL_SIZE+1)),this.uHeight-1),l=Math.min(Math.floor(n/(this.CELL_SIZE+1)),this.uWidth-1);switch(e){case"glider":this.universe.spawn_glider(a,l);break;case"pulsar":this.universe.spawn_pulsar(a,l);break;default:this.universe.toggle_cell(a,l)}this.drawCells()}}drawGrid(){this.ctx.beginPath(),this.ctx.strokeStyle=this.GRID_COLOR;for(let t=0;t<=this.uWidth;++t){const e=(this.CELL_SIZE+1)*t+.5,s=(this.CELL_SIZE+1)*this.uHeight+.5;this.ctx.moveTo(e,0),this.ctx.lineTo(e,s)}for(let t=0;t<=this.uHeight;++t){const e=(this.CELL_SIZE+1)*this.uWidth+.5,s=(this.CELL_SIZE+1)*t+.5;this.ctx.moveTo(0,s),this.ctx.lineTo(e,s)}this.ctx.stroke()}drawCells(){const t=this.universe.cells(),e=new Uint8Array(r.memory.buffer,t,this.uHeight*this.uWidth),s=this.universe.cells_diff(),n=this.universe.cells_diff_len(),h=new Uint32Array(r.memory.buffer,s,n),a=[],l=[];for(let t of h){const s=Math.floor(t%this.uWidth),r=Math.floor(t/this.uWidth);e[t]===i.bL.Alive?a.push([s,r]):l.push([s,r])}this.ctx.beginPath(),this.ctx.fillStyle=this.ALIVE_COLOR;for(let[t,e]of a)this.ctx.fillRect((this.CELL_SIZE+1)*t+1,(this.CELL_SIZE+1)*e+1,this.CELL_SIZE,this.CELL_SIZE);this.ctx.fillStyle=this.DEAD_COLOR;for(let[t,e]of l)this.ctx.fillRect((this.CELL_SIZE+1)*t+1,(this.CELL_SIZE+1)*e+1,this.CELL_SIZE,this.CELL_SIZE);this.ctx.stroke()}}).jumpstart();u()},422:(t,e,s)=>{var i=s.w[t.id];t.exports=i,s(409),i[""]()}}]);